# 客服聊天记录处理系统

## 功能概述
该系统用于处理客服聊天记录，提取有效的问答对，并进行数据清洗和分析。主要功能包括：

1. 数据清洗
   - 文本标准化和编码处理
   - 敏感信息脱敏（身份证号、手机号、邮箱等）
   - 无效内容过滤
   - 标点符号标准化

2. 问答对提取
   - 基于会话ID的对话分组
   - 问题和回答的智能匹配
   - 相似内容合并和去重
   - 代表性问答对选择

3. 数据分析
   - 数据质量诊断
   - 标签提取和分类
   - 统计报告生成

## 数据清洗规则

### 1. 敏感信息脱敏
- 身份证号：保留前6位和后4位
- 手机号：保留前3位和后4位
- 邮箱地址：保留@前2位和完整域名
- 银行卡号：保留前6位和后4位
- 中文姓名：保留姓氏
- 地址：保留省份和城市信息
- 车牌号：保留省份简称和最后两位
- 微信号：统一替换为"微信号：******"
- QQ号：统一替换为"QQ号：******"
- 网址：统一替换为"http://******"
- 日期时间：保留年月信息

### 2. 无效内容过滤
- 系统消息和标记（[图片]、[表情]等）
- 自动回复和模板消息
- 纯表情符号
- 纯数字和标点
- 纯英文和标点
- 纯中文标点
- 纯空格和换行
- 重复的标点符号
- 多余的空格

### 3. 问答匹配规则
- 基于会话ID进行对话分组
- 计算问题和回答的匹配度
- 设置匹配度阈值（0.3）
- 过滤客服回复中的以下类型：
  - 疑问句（如："请问是XXXX呢？"，"XXX吗？"）
  - 非陈述句
  - 需要客户提供信息的回复（如："请提供XXX"，"XXX发一下"）
- 选择最匹配的问答对

## 输出格式

### 1. 问答对（qa_pairs.xlsx）
- 客户ID
- 客服ID
- 问题内容
- 回答内容
- 时间戳
- 会话ID
- 问题标签

### 2. 知识库（knowledge_base.json）
- 问题
- 回答
- 标签列表
- 数据来源
- 有效期

### 3. 诊断报告（diagnostic_report.json）
- 数据质量指标
- 统计信息
- 处理结果分析

## 使用说明

1. 准备数据
   - 将聊天记录保存为Excel文件（data.xlsx）
   - 确保包含必要的列：消息来源、聊天内容、消息时间、会话ID

2. 运行程序
   ```bash
   python chat_qa_processor.py
   ```

3. 查看结果
   - 输出文件保存在output目录下
   - 包含问答对、知识库和诊断报告

## 注意事项

1. 数据格式要求
   - Excel文件必须包含必要的列
   - 时间格式需要统一
   - 消息来源需要符合格式要求

2. 处理规则
   - 敏感信息会被自动脱敏
   - 无效内容会被过滤
   - 匹配度低的问答对会被忽略

3. 输出说明
   - 所有输出文件使用UTF-8编码
   - 时间格式统一为ISO格式
   - 标签使用列表格式存储

## 安装依赖

```bash
pip install -r requirements.txt
```

## 更新日志

### v1.0.0 (2024-03-27)
- 初始版本发布
- 实现基础的数据清洗和分析功能
- 支持问答对提取和知识库转换 



